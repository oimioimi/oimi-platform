<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>منصة OIMI - طلب تقييم</title>

    <meta property="og:title" content="منصة OIMI - طلب تقييم">
    <meta property="og:description" content="منصة رقمية رائدة لتقديم الحلول المهنية المتكاملة وبناء السير الذاتية الاحترافية.">
    <meta property="og:image" content="https://i.postimg.cc/cJRw69tq/Favicon-for-OIMI.png">
    <meta property="og:url" content="https://www.oimi.ae">
    <meta property="og:type" content="website">

    <link rel="icon" type="image/png" href="https://i.postimg.cc/cJRw69tq/Favicon-for-OIMI.png">

    <style>
        :root { --p: #00732f; --lg: #e8f5e9; }
        body { background: #fff; margin: 0; font-family: 'Segoe UI', sans-serif; padding: 5px; text-align: right; overflow-x: hidden; }
        .container { max-width: 600px; margin: auto; display: flex; flex-direction: column; gap: 2px; }
        .card { background: #fff; padding: 18px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); border: 1px solid #eee; }

        .oimi-style { display: inline-flex; align-items: baseline; direction: ltr; font-weight: bold; color: #000; }
        .oimi-i { 
            display: inline-block; line-height: 1;
            background: linear-gradient(to bottom, #ff0000 20%, #000000 20%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            padding: 0; margin: 0;
        }

        .main-title { text-align: center; margin-bottom: 8px; font-weight: 800; font-size: 22px; }
        .main-title .oimi-style { font-size: 34px; } 

        .box { background: var(--lg); padding: 12px; border-radius: 10px; border: 1px solid var(--p); margin-bottom: 10px; color: #2e7d32; font-size: 13px; line-height: 1.6; }
        .separator { border-top: 1px dashed var(--p); margin: 8px 0; opacity: 0.5; }
        label { display: block; margin: 4px 0 2px; font-weight: bold; font-size: 13px; color: #444; }
        input, select, textarea { width: 100%; padding: 10px; margin-bottom: 5px; border-radius: 8px; border: 1px solid #ccc; box-sizing: border-box; font-size: 14px; background: #f9f9f9; font-weight: bold; }
        .num-input { direction: ltr; text-align: left; }
        input:disabled { background: #f0f0ff !important; cursor: not-allowed; color: #888; border: 1px solid #ddd; }

        .slider { width: 100%; overflow: hidden; margin-top: 15px; text-align: center; direction: ltr; position: relative; height: 260px; }
        .slider h4 { color: var(--p); margin: 5px 0; font-size: 16px; direction: rtl; }
        .track { display: flex; width: max-content; animation: scroll-loop 25s linear infinite; padding: 20px 0; align-items: center; }
        .track img { width: 260px; height: 160px; object-fit: cover; margin: 0 15px; border-radius: 12px; box-shadow: 0 8px 20px rgba(0,0,0,0.1); transition: 0.3s; cursor: zoom-in; }
        @keyframes scroll-loop { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }

        #modalOverlay { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); z-index: 10000; align-items:center; justify-content:center; }
        #modalOverlay img { max-width: 90%; max-height: 80%; border: 3px solid #fff; border-radius: 10px; }

        .footer-section { background: #fff; border-top: 1px solid #eee; margin-top: 15px; padding: 15px; text-align: center; }
        .f-title { color: var(--p); font-size: 19px; display: bold; margin-bottom: 8px; }
        .f-intro { font-size: 13.5px; line-height: 1.6; color: #333; margin-bottom: 5px; text-align: justify; direction: rtl; }
        #details-box { display: none; background: #fdfdfd; padding: 15px; border-radius: 12px; border: 1px solid #ddd; margin-top: 10px; font-size: 13px; text-align: right; }

        .btn { width: 100%; background: linear-gradient(135deg, #00732f, #00a342); color: white; padding: 14px; border: none; border-radius: 10px; font-size: 16px; font-weight: bold; cursor: pointer; margin-top: 5px; }
        .btn:disabled { background: #999; }
    </style>
</head>
<body>

<div id="modalOverlay" onclick="this.style.display='none'"><img id="modalImg"></div>

<div class="container">
    <div class="card">
        <h2 class="main-title">منصة <span class="oimi-style">O<span class="oimi-i">i</span>M<span class="oimi-i">i</span>.ae</span></h2>
        
        <form id="oimi-form">
            <div class="box">
                <strong>✅ تنبيه هام:</strong><br>
                يسمح بالتسجيل مرة واحدة فقط لكل بريد إلكتروني. إذا كنت مسجلاً مسبقاً، يرجى التواصل معنا لمتابعة طلبك.
            </div>

            <label>الاسم الرباعي (بالعربية) *</label>
            <input type="text" id="u_name_ar" required>
            <label>الاسم الرباعي (بالإنجليزية) *</label>
            <input type="text" id="u_name_en" class="num-input" required>
            <label>التخصص المهني *</label>
            <input type="text" id="u_spec" required>
            <label>بلد الاقامة *</label>
            <select id="u_country" required onchange="handleCountryChange(this)"><option value="">اختر الدولة...</option></select>
            <label>رقم الهاتف *</label>
            <input type="tel" id="u_phone" class="num-input" disabled required>
            <label>رقم الواتساب *</label>
            <input type="tel" id="u_whatsapp" class="num-input" disabled required>
            <label>البريد الالكتروني *</label>
            <input type="email" id="u_email" required>
            <label>ملاحظات</label>
            <textarea id="u_notes" rows="2"></textarea>
            <label>كيف سمعت عنا؟ *</label>
            <select id="u_source" required>
                <option value="">اختر المصدر...</option>
                <option value="فيسبوك">فيسبوك</option>
                <option value="لينكد إن">لينكد إن</option>
                <option value="تيك توك">تيك توك</option>
                <option value="صديق">صديق</option>
            </select>

            <div class="separator"></div>
            <label>أرفق السيرة الذاتية *</label>
            <input type="file" id="cv_file" accept=".pdf,image/*" required>
            <label>صورة إيصال التحويل *</label>
            <input type="file" id="receipt_file" accept="image/*" required>

            <button type="submit" class="btn" id="submitBtn">إرسال الطلب</button>
        </form>
    </div>

    <div class="slider">
        <div class="track">
            <img src="https://i.postimg.cc/vHPSwW3p/528604980-10162083330481298-381945114741787991-n.jpg" onclick="zoomImg(this.src)">
            <img src="https://i.postimg.cc/sDn0Cpwb/585747945-10162491435001298-5020852638269490297-n.jpg" onclick="zoomImg(this.src)">
            <img src="https://i.postimg.cc/Wb9fcMXY/QVZo-ZFNzc-Wdi-MUx2a-HJMUFRhe-GJza-TZI.jpg" onclick="zoomImg(this.src)">
            <img src="https://i.postimg.cc/vHPSwW3p/528604980-10162083330481298-381945114741787991-n.jpg" onclick="zoomImg(this.src)">
        </div>
    </div>
</div>

<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbyPDBr-Msg4IdfCZSV6XOqQAiKCfGcoCsg2Er-bsF1snJF8U-4qZVl8578wfw6vp5aX/exec";

const countryCodes = { "أفغانستان": "0093","الجزائر": "00213","البحرين": "00973","مصر": "0020","العراق": "00964","الأردن": "00962","الكويت": "00965","لبنان": "00961","ليبيا": "00218","المغرب": "00212","عمان": "00968","فلسطين": "00970","قطر": "00974","السعودية": "00966","السودان": "00249","سوريا": "00963","تونس": "00216","تركيا": "0090","الإمارات العربية المتحدة": "00971","اليمن": "00967","المملكة المتحدة": "0044","الولايات المتحدة": "001" };
const cSel = document.getElementById('u_country');
Object.keys(countryCodes).sort((a,b)=>a.localeCompare(b,'ar')).forEach(c=>{ const o=document.createElement('option'); o.value=c; o.textContent=c; cSel.appendChild(o); });

function handleCountryChange(el){ 
    const p=document.getElementById('u_phone'), w=document.getElementById('u_whatsapp'); 
    if(el.value){ p.disabled=false; w.disabled=false; p.value=countryCodes[el.value]; w.value=countryCodes[el.value]; } 
}
function zoomImg(src){ document.getElementById('modalImg').src=src; document.getElementById('modalOverlay').style.display='flex'; }

const form = document.getElementById('oimi-form');
form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const btn = document.getElementById('submitBtn');
    btn.disabled = true; btn.innerHTML = "جاري التحقق والحفظ...";

    const toBase64 = file => new Promise((resolve, reject) => {
        const reader = new FileReader(); reader.readAsDataURL(file);
        reader.onload = () => resolve(reader.result.split(',')[1]);
        reader.onerror = e => reject(e);
    });

    try {
        const cvF = document.getElementById('cv_file').files[0];
        const rcF = document.getElementById('receipt_file').files[0];
        const payload = {
            "الاسم العربي": document.getElementById('u_name_ar').value,
            "الاسم الانجليزي": document.getElementById('u_name_en').value,
            "التخصص المهني": document.getElementById('u_spec').value,
            "بلد الإقامة": document.getElementById('u_country').value,
            "رقم الهاتف": document.getElementById('u_phone').value,
            "رقم الواتس": document.getElementById('u_whatsapp').value,
            "البريد الإلكتروني": document.getElementById('u_email').value,
            "ملاحظات": document.getElementById('u_notes').value,
            "كيف سمعت عننا": document.getElementById('u_source').value,
            "cv_name": cvF.name, "cv_data": await toBase64(cvF),
            "receipt_name": rcF.name, "receipt_data": await toBase64(rcF)
        };

        const resp = await fetch(scriptURL, { method: 'POST', body: JSON.stringify(payload) });
        const res = await resp.json();

        if (res.status === "exists") {
            alert(res.message);
            btn.disabled = false; btn.innerHTML = "إرسال الطلب";
        } else if (res.status === "success") {
            alert(`تم استلام طلبك بنجاح ✅\nرقم تسجيلك: ${res.uniqueId}`);
            window.open(`https://wa.me/249900065080?text=${encodeURIComponent('رقم تسجيلي: ' + res.uniqueId)}`, '_blank');
            location.reload();
        }
    } catch (e) {
        alert("حدث خطأ، يرجى المحاولة لاحقاً.");
        btn.disabled = false; btn.innerHTML = "إرسال الطلب";
    }
});
</script>
</body>
</html>
